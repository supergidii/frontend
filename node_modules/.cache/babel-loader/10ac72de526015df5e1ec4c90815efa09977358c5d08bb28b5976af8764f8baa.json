{"ast":null,"code":"import React,{useState}from'react';import'./Deposit.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE_URL=process.env.REACT_APP_API_BASE_URL||'https://netgift1aviator.pythonanywhere.com/api';function Deposit(){const[amount,setAmount]=useState('');const[success,setSuccess]=useState('');const[error,setError]=useState('');const[txnCode,setTxnCode]=useState('');const initiateStk=async()=>{const token=localStorage.getItem('access_token');if(!token){localStorage.setItem('post_login_redirect',JSON.stringify({path:window.location.pathname,action:'deposit',payload:{amount}}));window.location.href='/login';return;}if(!amount){setError('Enter an amount first');return;}try{await fetch(`${API_BASE_URL}/api/mpesa/stkpush/?amount=${encodeURIComponent(amount)}`,{method:'GET',headers:{'Authorization':`Bearer ${token}`}});setError('');setSuccess('STK Push sent. Enter your M-Pesa PIN to complete. Your balance will update automatically after confirmation.');}catch(e){setError('Failed to initiate STK Push');}};const submitManualTxn=async()=>{const token=localStorage.getItem('access_token');if(!token){localStorage.setItem('post_login_redirect',JSON.stringify({path:window.location.pathname,action:'deposit',payload:{amount,txnCode}}));window.location.href='/login';return;}if(!amount||!txnCode){setError('Enter amount and transaction code');return;}try{const resp=await fetch(`${API_BASE_URL}/api/mpesa/manual/`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`},body:JSON.stringify({amount,transaction_code:txnCode})});if(!resp.ok)throw new Error('Manual submission failed');setError('');setSuccess('Transaction submitted. Your balance will update once verified.');}catch(e){setError('Failed to submit transaction');}};return/*#__PURE__*/_jsx(\"div\",{className:\"deposit-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-card\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Deposit\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"success-message\",children:success}),/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-section\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",placeholder:\"Enter amount\",value:amount,onChange:e=>setAmount(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:initiateStk,children:\"Pay via M-Pesa (STK Push)\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"divider\",children:\"OR\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"till-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Pay Manually via Till\"}),/*#__PURE__*/_jsxs(\"ol\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Go to M-Pesa on your phone\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Select Lipa na M-Pesa\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Select Buy Goods and Services\"}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Enter Till Number: \",/*#__PURE__*/_jsx(\"strong\",{children:\"9827355\"})]}),/*#__PURE__*/_jsx(\"li\",{children:\"Enter Amount: your desired deposit\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Enter your M-Pesa PIN and confirm\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Once we receive the confirmation from M-Pesa, your balance will be updated automatically.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"deposit-section\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Transaction Code (e.g., TIH9DTMQR7)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter M-Pesa transaction code\",value:txnCode,onChange:e=>setTxnCode(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:submitManualTxn,children:\"Submit Transaction Code\"})]})]})]})});}export default Deposit;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","Deposit","amount","setAmount","success","setSuccess","error","setError","txnCode","setTxnCode","initiateStk","token","localStorage","getItem","setItem","JSON","stringify","path","window","location","pathname","action","payload","href","fetch","encodeURIComponent","method","headers","e","submitManualTxn","resp","body","transaction_code","ok","Error","className","children","type","min","placeholder","value","onChange","target","onClick"],"sources":["C:/Users/Antoo/Desktop/betting/betsite/frontend/src/components/Deposit.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport './Deposit.css';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'https://netgift1aviator.pythonanywhere.com/api';\r\n\r\nfunction Deposit() {\r\n  const [amount, setAmount] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [txnCode, setTxnCode] = useState('');\r\n\r\n  const initiateStk = async () => {\r\n    const token = localStorage.getItem('access_token');\r\n    if (!token) {\r\n      localStorage.setItem('post_login_redirect', JSON.stringify({ path: window.location.pathname, action: 'deposit', payload: { amount } }));\r\n      window.location.href = '/login';\r\n      return;\r\n    }\r\n    if (!amount) {\r\n      setError('Enter an amount first');\r\n      return;\r\n    }\r\n    try {\r\n      await fetch(`${API_BASE_URL}/api/mpesa/stkpush/?amount=${encodeURIComponent(amount)}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n      setError('');\r\n      setSuccess('STK Push sent. Enter your M-Pesa PIN to complete. Your balance will update automatically after confirmation.');\r\n    } catch (e) {\r\n      setError('Failed to initiate STK Push');\r\n    }\r\n  };\r\n\r\n  const submitManualTxn = async () => {\r\n    const token = localStorage.getItem('access_token');\r\n    if (!token) {\r\n      localStorage.setItem('post_login_redirect', JSON.stringify({ path: window.location.pathname, action: 'deposit', payload: { amount, txnCode } }));\r\n      window.location.href = '/login';\r\n      return;\r\n    }\r\n    if (!amount || !txnCode) {\r\n      setError('Enter amount and transaction code');\r\n      return;\r\n    }\r\n    try {\r\n      const resp = await fetch(`${API_BASE_URL}/api/mpesa/manual/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`\r\n        },\r\n        body: JSON.stringify({ amount, transaction_code: txnCode })\r\n      });\r\n      if (!resp.ok) throw new Error('Manual submission failed');\r\n      setError('');\r\n      setSuccess('Transaction submitted. Your balance will update once verified.');\r\n    } catch (e) {\r\n      setError('Failed to submit transaction');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"deposit-page\">\r\n      <div className=\"deposit-card\">\r\n        <h1>Deposit</h1>\r\n\r\n        {error && <div className=\"error-message\">{error}</div>}\r\n        {success && <div className=\"success-message\">{success}</div>}\r\n\r\n        <div className=\"deposit-section\">\r\n          <label>Amount</label>\r\n          <input\r\n            type=\"number\"\r\n            min=\"1\"\r\n            placeholder=\"Enter amount\"\r\n            value={amount}\r\n            onChange={(e) => setAmount(e.target.value)}\r\n          />\r\n          <button type=\"button\" onClick={initiateStk}>Pay via M-Pesa (STK Push)</button>\r\n        </div>\r\n\r\n        <div className=\"divider\">OR</div>\r\n\r\n        <div className=\"till-section\">\r\n          <h2>Pay Manually via Till</h2>\r\n          <ol>\r\n            <li>Go to M-Pesa on your phone</li>\r\n            <li>Select Lipa na M-Pesa</li>\r\n            <li>Select Buy Goods and Services</li>\r\n            <li>Enter Till Number: <strong>9827355</strong></li>\r\n            <li>Enter Amount: your desired deposit</li>\r\n            <li>Enter your M-Pesa PIN and confirm</li>\r\n          </ol>\r\n          <p>Once we receive the confirmation from M-Pesa, your balance will be updated automatically.</p>\r\n          <div className=\"deposit-section\">\r\n            <label>Transaction Code (e.g., TIH9DTMQR7)</label>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Enter M-Pesa transaction code\"\r\n              value={txnCode}\r\n              onChange={(e) => setTxnCode(e.target.value)}\r\n            />\r\n            <button type=\"button\" onClick={submitManualTxn}>Submit Transaction Code</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Deposit;\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}