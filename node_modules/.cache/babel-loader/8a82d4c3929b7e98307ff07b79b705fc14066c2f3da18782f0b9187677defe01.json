{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import'./Navbar.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Navbar(){const[isDropdownOpen,setIsDropdownOpen]=useState(false);const[isMobileMenuOpen,setIsMobileMenuOpen]=useState(false);const[isLoggedIn,setIsLoggedIn]=useState(false);const[userInfo,setUserInfo]=useState(null);const[isAdmin,setIsAdmin]=useState(false);// Check authentication status on component mount\nuseEffect(()=>{const checkAuthStatus=async()=>{const accessToken=localStorage.getItem('access_token');if(accessToken){setIsLoggedIn(true);// Try to get user info from localStorage first\nconst userData=localStorage.getItem('user_info');if(userData){const user=JSON.parse(userData);setUserInfo(user);setIsAdmin(user.is_admin||false);}// Also fetch fresh user data from API to ensure admin status is current\ntry{const response=await fetch(`${process.env.REACT_APP_API_BASE_URL||'http://127.0.0.1:8000'}/api/auth/profile/`,{headers:{'Authorization':`Bearer ${accessToken}`,'Content-Type':'application/json'}});if(response.ok){const data=await response.json();const user=data.user||data;setUserInfo(user);setIsAdmin(user.is_admin||false);// Debug logging\nconsole.log('User profile data:',user);console.log('Is admin:',user.is_admin);console.log('Admin status set to:',user.is_admin||false);// Update localStorage with fresh data\nlocalStorage.setItem('user_info',JSON.stringify(user));}}catch(error){console.error('Failed to fetch user profile:',error);}}};checkAuthStatus();},[]);const toggleDropdown=()=>{setIsDropdownOpen(!isDropdownOpen);};const toggleMobileMenu=()=>{setIsMobileMenuOpen(!isMobileMenuOpen);};const handleLogout=()=>{// Clear all authentication data\nlocalStorage.removeItem('access_token');localStorage.removeItem('refresh_token');localStorage.removeItem('user_info');setIsLoggedIn(false);setUserInfo(null);// Redirect to home page\nwindow.location.href='/';};// Close dropdown and mobile menu when clicking outside\nuseEffect(()=>{const handleClickOutside=event=>{if(isDropdownOpen&&!event.target.closest('.navbar-dropdown')){setIsDropdownOpen(false);}if(isMobileMenuOpen&&!event.target.closest('.navbar')){setIsMobileMenuOpen(false);}};document.addEventListener('mousedown',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[isDropdownOpen,isMobileMenuOpen]);return/*#__PURE__*/_jsxs(\"nav\",{className:\"navbar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"navbar-brand\",children:/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"navbar-logo\",children:\"Virtual Betting\"})}),/*#__PURE__*/_jsxs(\"button\",{className:`mobile-menu-toggle ${isMobileMenuOpen?'active':''}`,onClick:toggleMobileMenu,\"aria-label\":\"Toggle mobile menu\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"hamburger-line\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hamburger-line\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hamburger-line\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:`navbar-menu ${isMobileMenuOpen?'mobile-open':''}`,children:[/*#__PURE__*/_jsx(Link,{to:\"/home\",className:\"navbar-item\",onClick:()=>setIsMobileMenuOpen(false),children:\"Home\"}),/*#__PURE__*/_jsx(Link,{to:\"/aviator\",className:\"navbar-item\",onClick:()=>setIsMobileMenuOpen(false),children:\"Aviator\"}),/*#__PURE__*/_jsx(Link,{to:\"/deposit\",className:\"navbar-item\",onClick:()=>setIsMobileMenuOpen(false),children:\"Deposit\"}),isLoggedIn&&isAdmin&&/*#__PURE__*/_jsx(Link,{to:\"/admin/referrals\",className:\"navbar-item admin-link\",onClick:()=>setIsMobileMenuOpen(false),children:\"Admin Dashboard\"}),isLoggedIn?/*#__PURE__*/_jsxs(\"div\",{className:\"navbar-user-section\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-phone\",children:(userInfo===null||userInfo===void 0?void 0:userInfo.phone_number)||'User'}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:handleLogout,children:\"Logout\"})]}):/*#__PURE__*/_jsx(Link,{to:\"/login\",className:\"navbar-item\",onClick:()=>setIsMobileMenuOpen(false),children:\"Login\"})]})]});}export default Navbar;","map":{"version":3,"names":["React","useState","useEffect","Link","jsx","_jsx","jsxs","_jsxs","Navbar","isDropdownOpen","setIsDropdownOpen","isMobileMenuOpen","setIsMobileMenuOpen","isLoggedIn","setIsLoggedIn","userInfo","setUserInfo","isAdmin","setIsAdmin","checkAuthStatus","accessToken","localStorage","getItem","userData","user","JSON","parse","is_admin","response","fetch","process","env","REACT_APP_API_BASE_URL","headers","ok","data","json","console","log","setItem","stringify","error","toggleDropdown","toggleMobileMenu","handleLogout","removeItem","window","location","href","handleClickOutside","event","target","closest","document","addEventListener","removeEventListener","className","children","to","onClick","phone_number"],"sources":["C:/Users/Antoo/Desktop/betting/betsite/frontend/src/components/Navbar.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport './Navbar.css';\r\n\r\nfunction Navbar() {\r\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n  const [userInfo, setUserInfo] = useState(null);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n  // Check authentication status on component mount\r\n  useEffect(() => {\r\n    const checkAuthStatus = async () => {\r\n      const accessToken = localStorage.getItem('access_token');\r\n      if (accessToken) {\r\n        setIsLoggedIn(true);\r\n        \r\n        // Try to get user info from localStorage first\r\n        const userData = localStorage.getItem('user_info');\r\n        if (userData) {\r\n          const user = JSON.parse(userData);\r\n          setUserInfo(user);\r\n          setIsAdmin(user.is_admin || false);\r\n        }\r\n        \r\n        // Also fetch fresh user data from API to ensure admin status is current\r\n        try {\r\n          const response = await fetch(`${process.env.REACT_APP_API_BASE_URL || 'http://127.0.0.1:8000'}/api/auth/profile/`, {\r\n            headers: {\r\n              'Authorization': `Bearer ${accessToken}`,\r\n              'Content-Type': 'application/json'\r\n            }\r\n          });\r\n          \r\n          if (response.ok) {\r\n            const data = await response.json();\r\n            const user = data.user || data;\r\n            setUserInfo(user);\r\n            setIsAdmin(user.is_admin || false);\r\n            \r\n            // Debug logging\r\n            console.log('User profile data:', user);\r\n            console.log('Is admin:', user.is_admin);\r\n            console.log('Admin status set to:', user.is_admin || false);\r\n            \r\n            // Update localStorage with fresh data\r\n            localStorage.setItem('user_info', JSON.stringify(user));\r\n          }\r\n        } catch (error) {\r\n          console.error('Failed to fetch user profile:', error);\r\n        }\r\n      }\r\n    };\r\n    \r\n    checkAuthStatus();\r\n  }, []);\r\n\r\n  const toggleDropdown = () => {\r\n    setIsDropdownOpen(!isDropdownOpen);\r\n  };\r\n\r\n  const toggleMobileMenu = () => {\r\n    setIsMobileMenuOpen(!isMobileMenuOpen);\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    // Clear all authentication data\r\n    localStorage.removeItem('access_token');\r\n    localStorage.removeItem('refresh_token');\r\n    localStorage.removeItem('user_info');\r\n    setIsLoggedIn(false);\r\n    setUserInfo(null);\r\n    \r\n    // Redirect to home page\r\n    window.location.href = '/';\r\n  };\r\n\r\n  // Close dropdown and mobile menu when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (isDropdownOpen && !event.target.closest('.navbar-dropdown')) {\r\n        setIsDropdownOpen(false);\r\n      }\r\n      if (isMobileMenuOpen && !event.target.closest('.navbar')) {\r\n        setIsMobileMenuOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isDropdownOpen, isMobileMenuOpen]);\r\n\r\n  return (\r\n    <nav className=\"navbar\">\r\n      <div className=\"navbar-brand\">\r\n        <Link to=\"/\" className=\"navbar-logo\">\r\n          Virtual Betting\r\n        </Link>\r\n      </div>\r\n      \r\n      {/* Mobile Menu Toggle */}\r\n      <button \r\n        className={`mobile-menu-toggle ${isMobileMenuOpen ? 'active' : ''}`}\r\n        onClick={toggleMobileMenu}\r\n        aria-label=\"Toggle mobile menu\"\r\n      >\r\n        <span className=\"hamburger-line\"></span>\r\n        <span className=\"hamburger-line\"></span>\r\n        <span className=\"hamburger-line\"></span>\r\n      </button>\r\n\r\n      <div className={`navbar-menu ${isMobileMenuOpen ? 'mobile-open' : ''}`}>\r\n        <Link to=\"/home\" className=\"navbar-item\" onClick={() => setIsMobileMenuOpen(false)}>Home</Link>\r\n        {/* Games dropdown removed per request */}\r\n        <Link to=\"/aviator\" className=\"navbar-item\" onClick={() => setIsMobileMenuOpen(false)}>Aviator</Link>\r\n        <Link to=\"/deposit\" className=\"navbar-item\" onClick={() => setIsMobileMenuOpen(false)}>Deposit</Link>\r\n        \r\n        {/* Admin Dashboard - only show for admin users */}\r\n        {isLoggedIn && isAdmin && (\r\n          <Link to=\"/admin/referrals\" className=\"navbar-item admin-link\" onClick={() => setIsMobileMenuOpen(false)}>\r\n            Admin Dashboard\r\n          </Link>\r\n        )}\r\n        \r\n        \r\n        {/* Show different content based on authentication status */}\r\n        {isLoggedIn ? (\r\n          <div className=\"navbar-user-section\">\r\n            <span className=\"user-phone\">{userInfo?.phone_number || 'User'}</span>\r\n            <button className=\"logout-btn\" onClick={handleLogout}>Logout</button>\r\n          </div>\r\n        ) : (\r\n          <Link to=\"/login\" className=\"navbar-item\" onClick={() => setIsMobileMenuOpen(false)}>Login</Link>\r\n        )}\r\n      </div>\r\n    </nav>\r\n  );\r\n}\r\n\r\nexport default Navbar; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}